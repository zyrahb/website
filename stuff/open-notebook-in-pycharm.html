
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="How to open a managed Jupyter notebook (Vertex AI - Workbench) in Pycharm">
      
      
      
      
        <link rel="prev" href="how-to-build-website.html">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.33">
    
    
      
        <title>Open your Jupyter GCP notebook in Pycharm - Zyrah Bernardino</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-1-create-your-jupyter-notebook" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Zyrah Bernardino" class="md-header__button md-logo" aria-label="Zyrah Bernardino" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Zyrah Bernardino
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Open your Jupyter GCP notebook in Pycharm
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/zyrahb/website" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    zyrahb/website
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Zyrah Bernardino" class="md-nav__button md-logo" aria-label="Zyrah Bernardino" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Zyrah Bernardino
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zyrahb/website" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    zyrahb/website
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../whoami.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    whoami
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stuff
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Stuff
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="how-to-build-website.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to set up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Open your Jupyter GCP notebook in Pycharm
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="open-notebook-in-pycharm.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Open your Jupyter GCP notebook in Pycharm
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-create-your-jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create your Jupyter notebook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-add-your-ssh-key-to-the-vm-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Add your SSH key to the VM instance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-set-up-the-ssh-tunnel-and-interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Set up the SSH tunnel and interpreter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-a-new-jupyter-notebook-and-check-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create a new Jupyter notebook and check it works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    <span class="md-ellipsis">
      Sources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-create-your-jupyter-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create your Jupyter notebook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-add-your-ssh-key-to-the-vm-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Add your SSH key to the VM instance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-set-up-the-ssh-tunnel-and-interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Set up the SSH tunnel and interpreter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-create-a-new-jupyter-notebook-and-check-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Create a new Jupyter notebook and check it works
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    <span class="md-ellipsis">
      Sources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Open your Jupyter GCP notebook in Pycharm</h1>

<p>Managed Jupyter notebooks, like GCP's Workbench, is a great way to get started on a project. You can start prototyping 
and modelling in minutes. However, if you're like me, have imprinted to an IDE (for me it's Pycharm) and can't seem to work 
on anything else, here's how you can open your managed Jupyter notebook in Pycharm.</p>
<blockquote>
<p><strong>Warning:</strong>
This (interpreters via SSH) only works for the paid Pycharm Professional product.</p>
<p><strong>Note:</strong>
We copy the python binaries from the managed instance to your local machine and not ideal if 
you have bad internet, but this is only for setting up. Pycharm needs the binaries locally so it can do it's thing
like code completion, debugging, project-wide refactorings, etc.</p>
</blockquote>
<h2 id="step-1-create-your-jupyter-notebook">Step 1: Create your Jupyter notebook</h2>
<p>Open Vertex AI &gt; Workbench &gt; +CREATE NEW &gt; ADVANCED OPTIONS &gt; CREATE</p>
<p>All the default settings are fine but would beef up the machine type especially if you are doing some ML
and working with large datasets. If you do use the default service account make sure it has the right permissions.
You can't change the connected service account after creation. (Would be annoying to start over. Speaking from experience)</p>
<p><img alt="img_1.png" src="img_1.png" /></p>
<p>Once created, you can <code>OPEN JUPYTERLAB</code> and checkout all the notebook options.</p>
<p><img alt="img_2.png" src="img_2.png" /></p>
<p>The notebook is a VM and the External IP addresses is ephemeral, a new address is assigned everytime it's stop-starts.
Will need to configure to static and pin down an IP address. <a href="https://console.cloud.google.com/networking/addresses">VPC Network &gt; IP Addresses</a>. 
Will ask you what to name it. More info <a href="https://cloud.google.com/compute/docs/ip-addresses/configure-static-external-ip-address#console">here</a></p>
<p><img alt="img_3.png" src="img_3.png" /></p>
<p>Take note of the external IP address. This is what you will use to connect to the instance.</p>
<h2 id="step-2-add-your-ssh-key-to-the-vm-instance">Step 2: Add your SSH key to the VM instance</h2>
<p>If you don't have a SSH key, you can generate one with the following command:</p>
<pre><code class="language-bash">ssh-keygen -t rsa -f ~/.ssh/jupyter
</code></pre>
<p>Copy the public key and paste to a text editor. Update the last string which is the username to <code>jupyter</code>.
This will allow you to update notebooks you've created locally in the UI (the <code>OPEN JUPYTERLAB</code> option).</p>
<p><img alt="img_5.png" src="img_5.png" /></p>
<p>Since this a managed instance by Workbench, you can't add SSH keys in the instance UI. You'll need modify in Workbench 
via use the gcloud command line tool.</p>
<pre><code class="language-bash">gcloud workbench instances update &lt;NOTEBOOK-NAME&gt; --metadata=ssh-keys=&quot;jupyter:$(cat ~/.ssh/jupyter.pub)&quot; --location=us-central1-a --project &lt;PROJECT_ID&gt;
</code></pre>
<p>To ensure the instance uses the metadata ssh keys so will need to disable the OS login.</p>
<pre><code class="language-bash">gcloud workbench instances update &lt;NOTEBOOK-NAME&gt; --metadata=enable-oslogin=false --location=us-central1-a --project &lt;PROJECT_ID&gt;
</code></pre>
<p>You can check the instance's UI if the metadata updated correctly.</p>
<p><img alt="img_9.png" src="img_9.png" /></p>
<h2 id="step-3-set-up-the-ssh-tunnel-and-interpreter">Step 3: Set up the SSH tunnel and interpreter</h2>
<p>In a new project or existing one, go the bottom right at <code>Python Interpreter</code> &gt; <code>Add new Interpreter</code> &gt; <code>On SSH...</code></p>
<p><img alt="img_17.png" src="img_17.png" /></p>
<p>Host: is the static external IP address</p>
<p>Port: 22</p>
<p>Username: jupyter</p>
<p><img alt="img_14.png" src="img_14.png" /></p>
<p>Use <code>Key pair</code> with the path of the ssh key.
<img alt="img_15.png" src="img_15.png" /></p>
<p>Hopefully, you should be able to connect.
<img alt="img_13.png" src="img_13.png" /></p>
<p>Next is the interpreter path. This will depend on what what you want. You have the option for <code>python</code>, <code>pytorch</code>,
<code>tensorflow</code>, like in Workbench.</p>
<p><img alt="img_19.png" src="img_19.png" /></p>
<p>I would like to use <code>pytouch</code>. So select <code>Conda Environment</code>, might take a moment to think, then select the <code>pytorch</code> 
environment.</p>
<p><img alt="img_18.png" src="img_18.png" /></p>
<p>This takes a moment to set up. This is where we are copying the binaries from the managed instance to your local 
machine.</p>
<h2 id="step-4-create-a-new-jupyter-notebook-and-check-it-works">Step 4: Create a new Jupyter notebook and check it works</h2>
<p>Create a new Jupyter notebook and run a cell to see if it works. Check out the menu bar. You can see that it's 
tunnelling to the instance, with the <code>PyTorch</code> kernel that was set up in the interpreter. If you would like to use a
different kernel, you can set it up in the new interpreter.</p>
<p><img alt="img_20.png" src="img_20.png" /></p>
<p>As a sanity check I run <code>import torch</code> and check if bigquery is auth correctly. Now you are good to go!</p>
<h2 id="sources">Sources</h2>
<p>https://cloud.google.com/compute/docs/connect/add-ssh-keys
https://cloud.google.com/compute/docs/ip-addresses/configure-static-external-ip-address#console
https://youtu.be/6RlgQBB1UDU
https://www.jetbrains.com/help/pycharm/configuring-remote-interpreters-via-ssh.html#ssh</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.af256bd8.min.js"></script>
      
    
  </body>
</html>